<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GE Log√≠stica - Sistema de Cotizaci√≥n de Fletes (MVC)</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>

<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo-container">
                    <img src="https://www.gelogistica.co/wp-content/uploads/2025/05/pagina-logo.png" alt="GE Log√≠stica">
                </div>
                <div class="header-text">
                    <h1>Sistema de C√°lculo de Fletes - Modelo Mixto</h1>
                    <p>Dimensi√≥n Operativa (Volumen √ó Distancia) + Dimensi√≥n Financiera (Peso √ó Costos)</p>
                </div>
            </div>
        </header>

        <!-- M√≥dulo 1: Configuraci√≥n del Viaje -->
        <section class="card">
            <h2>Configuraci√≥n del Viaje</h2>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <!-- Ruta -->
                <div>
                    <div class="form-group">
                        <label for="ruta">Ruta de Transporte:</label>
                        <select id="ruta" onchange="cargarRuta()">
                            <option value="">-- Seleccione una ruta --</option>
                        </select>
                    </div>
                    <div id="infoRuta" class="info-box" style="display:none;">
                        <p><strong>Destinos disponibles:</strong> <span id="destinos"></span></p>
                        <p><strong>Distancia:</strong> <span id="distancia"></span> km</p>
                    </div>
                </div>

                <!-- Cami√≥n -->
                <div>
                    <div class="form-group">
                        <label for="tipoCamionSeleccionado">Tipo de Cami√≥n:</label>
                        <select id="tipoCamionSeleccionado" onchange="validarCapacidadCamion()">
                            <option value="">-- Seleccione tipo de cami√≥n --</option>
                            <option value="25">Cami√≥n 25 m¬≥</option>
                            <option value="37">Cami√≥n 37 m¬≥</option>
                            <option value="45">Cami√≥n 45 m¬≥</option>
                        </select>
                        <small style="color: #64748b; margin-top: 5px; display: block;">Seleccione el cami√≥n antes de
                            agregar clientes</small>
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px;">
                <div class="form-group">
                    <label for="fechaDespacho">Fecha de Despacho:</label>
                    <input type="date" id="fechaDespacho">
                </div>
                <div class="form-group">
                    <label for="observaciones">Observaciones:</label>
                    <input type="text" id="observaciones" placeholder="Notas adicionales del despacho">
                </div>
            </div>

            <!-- Agregar Destino -->
            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                <strong style="color: var(--text-dark); font-size: 0.9em; display: block; margin-bottom: 10px;">Agregar
                    Nuevo Destino a la Ruta</strong>
                <div style="display: grid; grid-template-columns: 2fr 1fr auto; gap: 10px;">
                    <input type="text" id="nuevoDestino" placeholder="Nombre del destino" class="form-control">
                    <input type="number" id="nuevoDestinoKm" placeholder="Kil√≥metros" min="1" class="form-control">
                    <button onclick="agregarDestinoARuta()" class="btn-secondary">Agregar Destino</button>
                </div>
            </div>
        </section>

        <!-- M√≥dulo 2: Gesti√≥n de Clientes y Productos -->
        <section class="card">
            <h2>Clientes y Carga del Cami√≥n</h2>
            <div
                style="background: #eff6ff; padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid #2563eb;">
                <p style="color: #1e40af; font-size: 0.875em; margin: 0; font-weight: 500;">
                    <strong>Modelo Mixto de C√°lculo:</strong><br>
                    ‚Ä¢ <strong>Operativo:</strong> El flete se asigna proporcionalmente por <strong>Volumen √ó
                        Distancia</strong><br>
                    ‚Ä¢ <strong>Financiero:</strong> El an√°lisis de rentabilidad se eval√∫a por <strong>Peso √ó Costo
                        SAP</strong>
                </p>
            </div>
            <div id="alertaCapacidad" class="alert alert-warning" style="display:none; margin-bottom: 15px;"></div>

            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 10px; align-items: end;">
                <div class="form-group" style="margin-bottom: 0;">
                    <label for="nombreCliente">Nombre del Cliente:</label>
                    <input type="text" id="nombreCliente" placeholder="Ingrese nombre del cliente">
                </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label for="destinoCliente">Destino Espec√≠fico:</label>
                    <select id="destinoCliente">
                        <option value="">-- Seleccione destino --</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label for="ordenCompraCliente">Orden de Compra:</label>
                    <input type="text" id="ordenCompraCliente" placeholder="OC-XXX">
                </div>
                <button onclick="agregarCliente()" class="btn-secondary" style="height: fit-content;">+ Agregar
                    Cliente</button>
            </div>

            <div id="clientesContainer"></div>
        </section>

        <!-- M√≥dulo 3: Resumen y C√°lculo del Despacho -->
        <section class="card">
            <h2>Resumen del Despacho</h2>
            <div class="summary-grid">
                <div class="summary-item">
                    <label>Volumen Total:</label>
                    <span id="volumenTotal">0.00 m¬≥</span>
                </div>
                <div class="summary-item">
                    <label>Tipo de Cami√≥n:</label>
                    <span id="tipoCamion">-</span>
                </div>
                <div class="summary-item">
                    <label>Ocupaci√≥n Real:</label>
                    <span id="ocupacionReal">-</span>
                </div>
                <div class="summary-item">
                    <label>Flete Total:</label>
                    <span id="fleteTotal">$ 0</span>
                </div>
                <div class="summary-item">
                    <label>Valor Total Productos:</label>
                    <span id="valorTotalProductos">$ 0</span>
                </div>
            </div>

            <!-- Detalle por Cliente -->
            <div id="detalleClientes" style="margin-top: 20px;">
                <h3 style="color: #1a3a52; margin-bottom: 12px; font-size: 1em; font-weight: 600;">Detalle por Cliente
                </h3>
                <div id="detalleClientesContainer"></div>
            </div>

            <button onclick="calcularDespacho()" class="btn-primary" style="margin-top: 15px;">Calcular
                Despacho</button>
        </section>

        <!-- M√≥dulo 4: Reporte Final Detallado -->
        <section class="card" id="reporteSection" style="display:none;">
            <h2>Reporte Final de Cotizaci√≥n</h2>

            <h3>Por Producto</h3>
            <div class="table-responsive">
                <table id="tablaProductos">
                    <thead>
                        <tr>
                            <th>Cliente</th>
                            <th>Destino</th>
                            <th>Distancia (km)</th>
                            <th>Producto</th>
                            <th>Unidades</th>
                            <th>Vol. Unit. (m¬≥)</th>
                            <th>Vol. Total (m¬≥)</th>
                            <th>Peso Unit. (kg)</th>
                            <th>Peso Total (kg)</th>
                            <th>Precio Unit.</th>
                            <th>Valor Total</th>
                            <th>Flete Asignado</th>
                            <th>% Flete/Venta</th>
                        </tr>
                    </thead>
                    <tbody id="tablaProductosBody"></tbody>
                </table>
            </div>

            <h3>Por Cliente</h3>
            <div class="table-responsive">
                <table id="tablaClientes">
                    <thead>
                        <tr>
                            <th>Cliente</th>
                            <th>Destino</th>
                            <th>Distancia (km)</th>
                            <th>Vol. Total (m¬≥)</th>
                            <th>Peso Total (kg)</th>
                            <th>Factor (Vol√óDist)</th>
                            <th>% Particip. Flete</th>
                            <th>Valor Total</th>
                            <th>Flete Total</th>
                            <th>% Flete/Venta</th>
                        </tr>
                    </thead>
                    <tbody id="tablaClientesBody"></tbody>
                </table>
            </div>

            <h3>An√°lisis del Modelo Mixto</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <!-- Dimensi√≥n Operativa -->
                <div style="background: #eff6ff; padding: 20px; border-radius: 8px; border: 1px solid #bfdbfe;">
                    <h4 style="color: #1e40af; margin: 0 0 15px 0; font-size: 1em;">üì¶ Dimensi√≥n Operativa (Volumen)
                    </h4>
                    <div id="resumenOperativo"></div>
                </div>

                <!-- Dimensi√≥n Financiera -->
                <div style="background: #f0fdf4; padding: 20px; border-radius: 8px; border: 1px solid #bbf7d0;">
                    <h4 style="color: #166534; margin: 0 0 15px 0; font-size: 1em;">üí∞ Dimensi√≥n Financiera (Peso)</h4>
                    <div id="resumenFinanciero"></div>
                </div>
            </div>

            <div class="actions">
                <button onclick="exportarReporte()" class="btn-secondary">Exportar Reporte</button>
                <button onclick="nuevoDespacho()" class="btn-secondary">Nuevo Despacho</button>
            </div>
        </section>
    </div>

    <!-- Modelos -->
    <script src="models/RutaModel.js"></script>
    <script src="models/CamionModel.js"></script>
    <script src="models/DespachoModel.js"></script>
    <script src="models/CalculoModel.js"></script>

    <!-- Vistas -->
    <script src="views/ConfiguracionViajeView.js"></script>
    <script src="views/ClientesView.js"></script>
    <script src="views/ResumenView.js"></script>
    <script src="views/ReportesView.js"></script>

    <!-- Controlador -->
    <script src="controllers/AppController.js"></script>

    <!-- Aplicaci√≥n Principal -->
    <script src="assets/js/app.js"></script>
</body>

</html>